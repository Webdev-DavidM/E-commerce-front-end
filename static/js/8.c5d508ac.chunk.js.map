{"version":3,"sources":["Pages/ShoppingBasket.module.css","Components/UIelements/CheckoutItem.module.css","Components/UIelements/CheckoutItem.js","Pages/ShoppingBasket.js"],"names":["module","exports","CheckoutItem","state","quantity","error","componentDidMount","props","details","setState","removeItem","id","localStorageKey","size","data","deleteItem","itemToDeleteFromStorage","basket","filter","item","localStorage","adjustQuantity","operator","updateBasket","qtyOfSizeInStock","prevState","localStorageItem","JSON","parse","getItem","setItem","stringify","this","name","images","price","className","styles","itemcontainer","imagecontainer","src","alt","itemdetails","style","color","priceandquanity","qtybtn1","onClick","amount","qtybtn2","bin","aria-hidden","itemcost","Component","connect","products","dispatch","updateToBasket","deleteItemFromBasket","ShoppingBasket","addBasket","length","Object","keys","map","index","console","log","itemsFromLocalStorage","undefined","isUserSignedIn","history","push","total","basketTotal","shoppingbasket","buttoncontainer","buttonshopping","disabled","buttoncheckout","token","textAlign","marginRight","Total","product","reduce","itemTotal","addToBasket"],"mappings":"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","file":"static/js/8.c5d508ac.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"shoppingbasket\":\"ShoppingBasket_shoppingbasket__3hPIk\",\"buttoncheckout\":\"ShoppingBasket_buttoncheckout__1THlB\",\"error\":\"ShoppingBasket_error__PUUnt\",\"gobackbtn\":\"ShoppingBasket_gobackbtn__3CoM3\",\"buttonshopping\":\"ShoppingBasket_buttonshopping__4IUxQ\",\"buttoncontainer\":\"ShoppingBasket_buttoncontainer__4kodM\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"itemcontainer\":\"CheckoutItem_itemcontainer__1VqFn\",\"details\":\"CheckoutItem_details__2NmzK\",\"error\":\"CheckoutItem_error__qhsIS\",\"imagecontainer\":\"CheckoutItem_imagecontainer__3MEKK\",\"itemdetails\":\"CheckoutItem_itemdetails__2eEq2\",\"qtybtn1\":\"CheckoutItem_qtybtn1__3bs4s\",\"qtybtn2\":\"CheckoutItem_qtybtn2__1jllo\",\"bin\":\"CheckoutItem_bin__3zcE1\",\"priceandquanity\":\"CheckoutItem_priceandquanity__BpTRf\",\"amount\":\"CheckoutItem_amount__33tZf\",\"rule\":\"CheckoutItem_rule__3l5bu\",\"qtybtn\":\"CheckoutItem_qtybtn__3PoBx\",\"itemcost\":\"CheckoutItem_itemcost__Ct5b3\"};","/* NPM packages */\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\n\n/* CSS */\nimport styles from './CheckoutItem.module.css';\n\n/* Action creators */\n\nimport {\n  updateToBasket,\n  deleteItemFromBasket,\n} from '../../Actions/products.js';\n\nclass CheckoutItem extends Component {\n  state = {\n    quantity: null,\n    error: '',\n  };\n\n  componentDidMount = () => {\n    let { quantity } = this.props.details;\n    this.setState({ quantity });\n  };\n\n  removeItem = (id, localStorageKey) => {\n    let { size } = this.props.details;\n    let data = { id, size };\n    this.props.deleteItem(data);\n\n    let itemToDeleteFromStorage = this.props.basket.filter(\n      (item) => item.id === id && item.size === this.props.details.size\n    );\n\n    // find the item in the basket via the id, then get the localstorage key and pass irt to the\n    // function below to remove the right one\n    localStorage.removeItem(\n      `item${itemToDeleteFromStorage[0].localStorageKey}`\n    );\n  };\n\n  adjustQuantity = (operator) => {\n    let { updateBasket } = this.props;\n    let { qtyOfSizeInStock } = this.props.details;\n    let { id, localStorageKey } = this.props;\n    if (operator === '-') {\n      if (this.state.quantity !== 0) {\n        updateBasket(id, this.state.quantity - 1);\n        this.setState((prevState) => ({\n          quantity: prevState.quantity - 1,\n          error: '',\n        }));\n        let localStorageItem = JSON.parse(\n          localStorage.getItem(`${localStorageKey}`)\n        );\n        localStorageItem['quantity'] = this.state.quantity - 1;\n        localStorage.setItem(\n          `${localStorageKey}`,\n          JSON.stringify(localStorageItem)\n        );\n      } else {\n        this.setState({ error: 'Nothing in basket' });\n      }\n    }\n    if (operator === '+') {\n      if (this.state.quantity < qtyOfSizeInStock) {\n        updateBasket(id, this.state.quantity + 1);\n        this.setState((prevState) => ({\n          quantity: prevState.quantity + 1,\n          error: '',\n        }));\n        let localStorageItem = JSON.parse(\n          localStorage.getItem(`${localStorageKey}`)\n        );\n        localStorageItem['quantity'] = this.state.quantity + 1;\n        localStorage.setItem(\n          `${localStorageKey}`,\n          JSON.stringify(localStorageItem)\n        );\n      } else {\n        this.setState({\n          error: `Maximum quantity available`,\n        });\n      }\n    }\n  };\n\n  render() {\n    let { name, images, price, size, id } = this.props.details;\n\n    let { localStorageKey } = this.props;\n\n    return (\n      <div className={styles.itemcontainer}>\n        <div className={styles.details}>\n          <div className={styles.imagecontainer}>\n            <img\n              src={`https://my-ecommerce-site-fitness.herokuapp.com/${images[0]}`}\n              alt=''\n            />\n          </div>\n          <div className={styles.itemdetails}>\n            <span>{name}</span>\n            <br />\n            <span>Size:{size}</span>\n            <br />\n            <span style={{ color: '#3498db' }}>£{price}</span>\n            <br />\n          </div>\n        </div>\n        <div> </div>\n        <div className={styles.priceandquanity}>\n          <div>\n            {' '}\n            <button\n              className={styles.qtybtn1}\n              onClick={() => this.adjustQuantity('-')}>\n              -\n            </button>\n            <span style={{ color: '#27ae60' }} className={styles.amount}>\n              {this.state.quantity}\n            </span>\n            <button\n              className={styles.qtybtn2}\n              onClick={() => this.adjustQuantity('+')}>\n              +\n            </button>\n          </div>\n          <button\n            className={styles.bin}\n            onClick={() => this.removeItem(id, localStorageKey)}>\n            <i className='fa fa-trash' aria-hidden='true'></i>\n          </button>\n\n          <h2 className={styles.itemcost} style={{ color: '#3498db' }}>\n            Total: £{price * this.state.quantity}\n          </h2>\n        </div>\n        <div className={styles.error}>\n          {this.state.error && <span>{this.state.error}</span>}\n        </div>\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return { basket: state.products.basket };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    updateBasket: (id, quantity) => dispatch(updateToBasket(id, quantity)),\n    deleteItem: (id) => dispatch(deleteItemFromBasket(id)),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(CheckoutItem);\n","/* NPM packages */\n\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\n\n/* CSS */\n\nimport styles from './ShoppingBasket.module.css';\n\n/* Components */\n\nimport CheckoutItem from '../Components/UIelements/CheckoutItem';\n\n/* Action creators */\n\nimport { addToBasket } from '../Actions/products.js';\n\nclass ShoppingBasket extends Component {\n  state = {\n    error: '',\n  };\n\n  componentDidMount = () => {\n    let { basket, addBasket } = this.props;\n\n    // here we check if there is something in the basket which means the user has come\n    // from the product screen, if so then add to local storage\n    if (basket.length !== 0) {\n      let localStorageItems = Object.keys(localStorage);\n      localStorageItems.map((item) => {\n        return item !== 'userInfo' && localStorage.removeItem(`${item}`);\n      });\n      basket.map((item, index) => {\n        console.log(item.localStorageKey);\n        return localStorage.setItem(\n          `item${item.localStorageKey}`,\n          JSON.stringify(item)\n        );\n      });\n    }\n\n    // here we check if the page has been refreshed and there is nothing in the basket, if there\n    // is an item in local storage then dispatch it to be added to basket in redux so it can populate this screen\n    let localStorageItems = Object.keys(localStorage);\n    let itemsFromLocalStorage = localStorageItems.map((item) =>\n      JSON.parse(localStorage.getItem(`${item}`))\n    );\n\n    if (basket.length === 0 && itemsFromLocalStorage)\n      // Here I will store the basket in local storage and reload if the user refreshes the page,\n      // I am mapping over the array and adding each item at a time which is what the reducer is expecting\n      itemsFromLocalStorage.map((item) => {\n        return item['firstName'] === undefined && addBasket(item);\n      });\n  };\n\n  isUserSignedIn = () => {\n    let token = JSON.parse(localStorage.getItem('userInfo'));\n    if (!token) {\n      this.setState({ error: 'Please sign in or create an account to buy' });\n    } else {\n      this.props.history.push('check-out');\n    }\n  };\n  render() {\n    let { basket, basketTotal } = this.props;\n\n    let total = basketTotal();\n\n    return (\n      <div className={styles.shoppingbasket}>\n        <h2>Your Shopping Basket</h2>\n        {this.state.error !== '' && (\n          <div className={styles.error}>{this.state.error}</div>\n        )}\n        <div className={styles.buttoncontainer}>\n          {' '}\n          <button\n            className={styles.buttonshopping}\n            onClick={() => this.props.history.push('/')}>\n            Continue Shopping\n          </button>\n          <button\n            disabled={basket.length === 0}\n            onClick={() => this.isUserSignedIn()}\n            className={styles.buttoncheckout}>\n            Proceed to checkout\n          </button>\n          <br />\n        </div>\n        {basket.map((item, index) => {\n          return (\n            !item.token && (\n              <div key={index}>\n                <CheckoutItem\n                  details={item}\n                  key={index}\n                  id={index}\n                  localStorageKey={`item${index}`}\n                />\n                <hr></hr>\n              </div>\n            )\n          );\n        })}\n        {basket.length === 0 && (\n          <h2 style={{ color: '#e74c3c' }}>Basket empty </h2>\n        )}\n        <h1\n          style={{ textAlign: 'right', marginRight: '4rem', color: '#27ae60' }}>\n          Total price: £{total.Total}\n        </h1>\n        <button\n          disabled={basket.length === 0}\n          className={styles.buttoncheckout}\n          onClick={() => this.isUserSignedIn()}>\n          Proceed to checkout\n        </button>\n        {this.state.error !== '' && (\n          <div className={styles.error}>{this.state.error}</div>\n        )}\n      </div>\n    );\n  }\n}\n\nconst mapStateToProps = (state) => {\n  return {\n    basket: state.products.basket,\n    basketTotal: () => {\n      let Total = 0;\n      if (state.products.basket.length !== 0) {\n        Total = state.products.basket\n          .map((product) => {\n            return product.price * product.quantity;\n          })\n          .reduce((total, itemTotal) => {\n            return total + itemTotal;\n          });\n      }\n\n      return { Total };\n    },\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    addBasket: (item) => dispatch(addToBasket(item)),\n  };\n};\n\nexport default connect(mapStateToProps, mapDispatchToProps)(ShoppingBasket);\n"],"sourceRoot":""}