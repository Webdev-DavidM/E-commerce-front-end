{"version":3,"sources":["Actions/orders.js","Pages/OrderDetails.module.css","Pages/OrderDetails.js"],"names":["sendOrderToServer","orderInfo","dispatch","a","type","axios","method","url","data","headers","token","response","status","products","console","log","request","error","getIndividualOrder","orderId","userInfo","JSON","parse","localStorage","getItem","userId","id","order","getOrdersForUser","user","orders","closeModal","module","exports","OrderDetails","state","rating","review","stars","reviewInProgress","productToReviewIndex","componentDidMount","props","match","params","getOrder","componentWillUnmount","setState","clearStatus","startReview","index","submitReview","submitUserReview","_id","productId","orderItems","item","firstName","comment","this","className","styles","gobackbtn","onClick","history","goBack","heading","orderscontainer","shippingpaymentcontainer","hr","orderitemscontainer","map","itemdetails","details","name","qty","price","reviewSuccess","reviewsuccess","reviewfail","reviewbtn","reviewcontainer","star","color","style","onChange","e","target","value","submitreviewbtn","backgroundColor","ordersummarycontainer","total","lastName","email","address","Component","mapStateToProps","reviewError","mapDispatchToProps","clearReviewStatus","withRouter","connect"],"mappings":"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","file":"static/js/10.357bfa6f.chunk.js","sourcesContent":["import axios from 'axios';\n\nexport const sendOrderToServer = (orderInfo) => {\n  return async (dispatch) => {\n    dispatch({ type: 'ORDER_SENT' });\n    try {\n      let response = await axios({\n        method: 'post',\n        url: `https://my-ecommerce-site-fitness.herokuapp.com/orders/new-order`,\n        data: {\n          orderInfo,\n        },\n        headers: {\n          token: orderInfo.token,\n        },\n      });\n      if (response.status === 201) {\n        dispatch({ type: 'ORDER_SUCCESS', products: response.data });\n      }\n    } catch (err) {\n      console.log(err.request);\n      if (err.request && err.request.status === 0) {\n        dispatch({\n          type: 'ORDER_FAIL',\n          error: 'Network error, please try again',\n        });\n      }\n    }\n    // dispatch({ type: 'ORDER_FAIL', error: err.response.data });\n  };\n};\n\nexport const getIndividualOrder = (orderId) => {\n  return async (dispatch) => {\n    let userInfo = JSON.parse(localStorage.getItem('userInfo'));\n    dispatch({ type: 'ORDER_SENT' });\n    try {\n      let response = await axios({\n        method: 'get',\n        url: `https://my-ecommerce-site-fitness.herokuapp.com/orders/order/${orderId}`,\n\n        headers: {\n          token: userInfo.token,\n          userId: userInfo.id,\n        },\n      });\n      if (response.status === 200) {\n        dispatch({ type: 'INDIVDUAL_ORDER_SUCCESS', order: response.data });\n      }\n    } catch (err) {\n      dispatch({ type: 'ORDER_FAIL', error: err.response.data });\n    }\n  };\n};\n\nexport const getOrdersForUser = ({ token, user }) => {\n  return async (dispatch) => {\n    dispatch({ type: 'ORDER_SENT' });\n    try {\n      let response = await axios({\n        method: 'get',\n        url: `https://my-ecommerce-site-fitness.herokuapp.com/orders/${user}`,\n        headers: {\n          token: token,\n        },\n      });\n      if (response.status === 200) {\n        dispatch({ type: 'ORDER_LIST_RECEIVED', orders: response.data });\n      }\n    } catch (err) {\n      console.log(err);\n      dispatch({ type: 'ORDER_FAIL', error: err });\n    }\n  };\n};\n\nexport const closeModal = () => {\n  return { type: 'CLOSE_MODAL' };\n};\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"heading\":\"OrderDetails_heading__1IQky\",\"orderscontainer\":\"OrderDetails_orderscontainer__3ZvNv\",\"shippingpaymentcontainer\":\"OrderDetails_shippingpaymentcontainer__peVSw\",\"submitreviewbtn\":\"OrderDetails_submitreviewbtn__3NjGc\",\"reviewbtn\":\"OrderDetails_reviewbtn__1u5Ft\",\"reviewcontainer\":\"OrderDetails_reviewcontainer__2a6D1\",\"itemdetails\":\"OrderDetails_itemdetails__2G89A\",\"review\":\"OrderDetails_review__2FFrq\",\"reviewfail\":\"OrderDetails_reviewfail__3WdDX\",\"reviewsuccess\":\"OrderDetails_reviewsuccess__NEOD5\",\"gobackbtn\":\"OrderDetails_gobackbtn__vm0xt\",\"orderitemscontainer\":\"OrderDetails_orderitemscontainer__2hY96\",\"star\":\"OrderDetails_star__jIlB6\",\"imagecontainer\":\"OrderDetails_imagecontainer__eP52I\",\"hr\":\"OrderDetails_hr__2y_WG\",\"status\":\"OrderDetails_status__1iNBE\",\"ordersummarycontainer\":\"OrderDetails_ordersummarycontainer__1fcE2\",\"details\":\"OrderDetails_details__NYox4\"};","/* NPM packages */\nimport React, { Component } from 'react';\nimport { connect } from 'react-redux';\nimport { withRouter } from 'react-router-dom';\n\n/* CSS */\n\nimport styles from './OrderDetails.module.css';\n\n/* Components */\n\n/* Action creators */\n\nimport { getIndividualOrder } from '../Actions/orders.js';\nimport { submitReview, clearReviewStatus } from '../Actions/products.js';\n\nclass OrderDetails extends Component {\n  state = {\n    rating: 0,\n    review: '',\n    stars: [1, 2, 3, 4, 5],\n    reviewInProgress: false,\n    productToReviewIndex: 0,\n    error: null,\n  };\n\n  componentDidMount = () => {\n    let { id } = this.props.match.params;\n    let { getOrder } = this.props;\n    getOrder(id);\n  };\n\n  componentWillUnmount = () => {\n    this.setState({ error: null });\n    this.props.clearStatus();\n  };\n\n  startReview = (index) => {\n    this.props.clearStatus();\n    this.setState({\n      rating: 0,\n      review: '',\n      reviewInProgress: true,\n      productToReviewIndex: index,\n      error: null,\n    });\n  };\n\n  submitReview = () => {\n    let { submitUserReview, order } = this.props;\n    console.log(order.user._id);\n\n    if (this.state.review !== '' && this.state.rating !== 0) {\n      this.setState({ error: null, reviewInProgress: false });\n      let data = {\n        productId: order.orderItems[this.state.productToReviewIndex].item,\n        userId: order.user._id,\n        firstName: order.user.firstName,\n        rating: this.state.rating,\n        comment: this.state.review,\n      };\n      submitUserReview(data);\n    } else {\n      this.setState({ error: 'Please giving a star rating and review' });\n    }\n  };\n\n  render() {\n    let { order } = this.props;\n    console.log(this.props.error);\n\n    return (\n      <>\n        {order !== null && (\n          <>\n            <span\n              className={styles.gobackbtn}\n              onClick={() => this.props.history.goBack()}>\n              Go back\n            </span>\n            <h2 className={styles.heading}>Order {order._id}</h2>\n            <div className={styles.orderscontainer}>\n              <div className={styles.shippingpaymentcontainer}>\n                <h3>SHIPPING</h3>\n\n                <div className={styles.status}>{order.status}</div>\n                <div className={styles.hr}></div>\n                <h3>PAYMENT</h3>\n                <span>Method: Paypal</span>\n                <div className={styles.status}>Paid</div>\n              </div>\n              <div className={styles.orderitemscontainer}>\n                <h2>Order Items</h2>\n                {order.orderItems.map((item, index) => (\n                  <>\n                    <div className={styles.itemdetails}>\n                      <div>\n                        <span className={styles.details}>{item.name}</span>\n                        <span className={styles.details}>\n                          &nbsp;:&nbsp;quantity&nbsp;{item.qty} x £{item.price}{' '}\n                          = £{item.price * item.qty}\n                        </span>\n                        {this.props.reviewSuccess &&\n                        this.state.productToReviewIndex === index ? (\n                          <p className={styles.reviewsuccess}>\n                            Reviewed successfully\n                          </p>\n                        ) : null}\n                        {this.props.error &&\n                        this.state.productToReviewIndex === index ? (\n                          <p className={styles.reviewfail}>\n                            {this.props.error}\n                          </p>\n                        ) : null}\n                      </div>\n\n                      {!this.state.reviewInProgress && (\n                        <span\n                          className={styles.reviewbtn}\n                          onClick={() => this.startReview(index)}>\n                          Submit a review\n                        </span>\n                      )}\n                    </div>\n                    {this.state.reviewInProgress &&\n                      this.state.productToReviewIndex === index && (\n                        <>\n                          <div className={styles.reviewcontainer}>\n                            <div>Rating</div>\n                            <div>\n                              {this.state.stars.map((star) => {\n                                let color =\n                                  this.state.rating >= star\n                                    ? {\n                                        color: '#f1c40f',\n                                      }\n                                    : null;\n\n                                return (\n                                  <span\n                                    className={styles.star}\n                                    onClick={() =>\n                                      this.setState({ rating: star })\n                                    }\n                                    style={color}>\n                                    <i className='fas fa-star'></i>\n                                  </span>\n                                );\n                              })}\n                            </div>\n\n                            <div>Review</div>\n                            <div>\n                              <input\n                                onChange={(e) =>\n                                  this.setState({ review: e.target.value })\n                                }\n                                value={this.state.review}\n                                className={styles.review}\n                                type='textarea'\n                              />\n                            </div>\n                            <span\n                              className={styles.submitreviewbtn}\n                              onClick={() => this.submitReview()}>\n                              Submit your review\n                            </span>\n\n                            {this.state.error && (\n                              <span\n                                className={styles.submitreviewbtn}\n                                style={{ backgroundColor: '#e74c3c' }}>\n                                {this.state.error}\n                              </span>\n                            )}\n                          </div>\n                        </>\n                      )}\n                  </>\n                ))}\n              </div>\n\n              <div className={styles.ordersummarycontainer}>\n                <h3>ORDER SUMMARY</h3>\n                <span>Items: £{order.total}</span>\n                <span>Delivery: £49</span>\n                <span>Total £{order.total + 49}</span>\n                <span>\n                  Name: {order.user.firstName} {order.user.lastName}\n                </span>\n                <span>Email: {order.user.email}</span>\n                <span>Address: {order.user.address}</span>\n              </div>\n            </div>\n          </>\n        )}\n      </>\n    );\n  }\n}\n\nexport const mapStateToProps = (state) => {\n  return {\n    order: state.orders.order,\n    error: state.products.reviewError,\n    reviewSuccess: state.products.reviewSuccess,\n  };\n};\n\nexport const mapDispatchToProps = (dispatch) => {\n  return {\n    getOrder: (id) => dispatch(getIndividualOrder(id)),\n    submitUserReview: (data) => dispatch(submitReview(data)),\n    clearStatus: () => dispatch(clearReviewStatus()),\n  };\n};\n\nexport default withRouter(\n  connect(mapStateToProps, mapDispatchToProps)(OrderDetails)\n);\n"],"sourceRoot":""}